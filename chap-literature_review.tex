\chapter{Related work}\label{chap:related_work}
\markboth{Related work}{}% To set left/right header
% \localtableofcontents

This chapter provides an overview of the related work on the key concepts that this thesis builds upon and compares with.

\section{Motion planning}

\subsection{Path planning}

This subsection provides an overview of various path planning approaches. 
For a more detailed survey, please refer to~\cite{cLavalle, cKavraki, cFrazzoli}.
The path planning problem focuses on finding a collision-free and/or optimal path between two configurations: a starting configuration and a goal configuration. 
The work of~\cite{cConfigSpace} introduced the configuration space concept as a general framework for planning motions in arbitrary kinematic systems.
This idea provided a solid foundation for the field and, as noted in~\cite{cSpatialPlan}, formally established the motion planning problem as the task of finding a path within the configuration space.

However, planning motion in the configuration space poses significant challenges due to the problem computational complexity. 
A key stone in addressing this issue is the introduction of artificial potential fields~\cite{cAPF}, which create a repulsive force field around obstacles and an attractive force field toward the target.
However, although this strategy has proven to be efficient, it sacrifices guarantees such as algorithm completeness and optimality.

Another common approach to the path planning problem involves search-based techniques. 
These methods operate on a discrete representation of the configuration space, where vertices correspond to a finite set of robot configurations, and edges represent possible transitions between these configurations.
The desired path is found by performing a search for a minimum-cost path in such a graph using Dijkstra algorithm~\cite{cDijk}. 

Advances in computational techniques have enabled the development of a new class of algorithms, commonly referred to as sampling-based planners that allow to generate global motion plans.
A key contribution of the domain is the work of~\cite{cLatombe}, which improves the aforementioned potential fields approach by integrating a random walk mechanism, thus guaranteeing the probabilistic completeness of the algorithm.
Sampling-based planners are divided in two main categories: graph-based planners and tree-based planners.

Graph-based sampling-based planners, such as \gls{prm}~\cite{cPRM}, generate a roadmap by sampling configurations in the free space and connecting them with feasible paths. 
The technique involves a graph building phase and a query phase.
The graph is first built by randomly sampling configurations (denoted nodes) in the robot configuration space.
Each sampled configuration is checked for collisions with obstacles.
For each collision-free node, the planner attempts to connect it to nearby free configurations by creating edges between them.  
The edges are valid if the path connecting the two configurations is collision-free.
This procedure typically involves a notion of neighborhood that is space-dependent and generally increases as the dimensionality of the space grows.
Once the graph is built, a graph search query is performed to compute the desired path, using graph search techniques such as Dijkstra algorithm~\cite{cDijk} or A*~\cite{cA*}.

The other planner family among sampling-based planners are tree-based planners such as the well-known \gls{rrt}~\cite{cRRT}.
This algorithm generates a tree starting from an initial configuration.
At each iteration, a new configuration is sampled $q^{rand}$.
It's nearest neighbor among the existing tree nodes is found $q^{near}$, and then an extension is attempt starting from $q^{near}$ toward $q^{rand}$ leading to a new configuration $q^{new}$.
If the extension is collision free, the new configuration is added to the tree as a new node with an edge connecting the two nodes.

Therefore, sampling-based motion planners have become one of the most widely used strategy for generating global motion paths in the presence of obstacles, due to their efficiency in handling complex and high-dimensional configuration spaces, as well as their completeness guarantee.
Advances in sampling-based planners have then focused on generating feasible and cost-effective paths through various strategies, such as the transition-based approach~\cite{cTRRT}. 
These strategies often achieve asymptotic optimality by employing optimal connection procedures during the tree or graph construction process~\cite{cRRTstar, cTRRTstar, cFMT}.
Research on sampling-based planners has expanded into various areas, such as developing suitable sampling strategies~\cite{cSampling}, exploring lazy collision checking approaches~\cite{cLazy1}, extending to the molecular domain~\cite{cMolecular}, and more.

The aforementioned sampling-based methods are generally referred to as global planning methods, as they rely on local planning techniques to generate the edges that connect the sampled configurations.
Such local planning methods are not considered global, as they do not address the entire motion planning problem. 
A local planner is typically fast; however, the generated path may not fully satisfy the problem constraints (e.g., it could result in collisions).
Traditional local strategies typically involve path segments, but local planners often need to account for additional constraints.
For example, significant work has been done to enforce kinematic constraints on these local plans, ensuring the kinematic feasibility of the resulting global paths.
Such work includes, for example, Dubins path generation~\cite{cDubins}, which enables connecting two configurations under forward motion constraints and curvature constraints for car-like robots. 
The Reeds-Shepp method~\cite{cReeds} extends this local path generation procedure to car-like robots capable of moving both forward and backward.

\subsection{Kinodynamic planning}

While the aforementioned path finding methods focus on generating a route between two robot configurations, they do not address the problem on how the robot should move along this route over time.
Additionally, path planning does not account for the robot dynamic constraints, such as maximum velocity and acceleration. 
The problem of generating motion plans that consider both kinematic constraints (e.g., turning radius) and dynamic constraints, ensuring the plans are physically executable, is known as kinodynamic motion planning.
Therefore, the kinodynamic problem extends beyond searching in the robot configuration space by considering its entire state space.

\subsubsection{Local planners}

Local planners, or steering methods, focus on generating feasible motion between two states while respecting kinematic and dynamic constraints. 
They are often used as building blocks in global kinodynamic planners. 

A common approach to generating smooth trajectories between robot states is to solve a two-point \gls{bvp} using polynomial-based methods, such as splines, which are widely employed for trajectory interpolation. 
For instance, the kinosplines local planner proposed in~\cite{cKino} leverages system differential flatness, ensuring the creation of continuous and differentiable trajectories up to the 4th order by employing a bang-bang snap control strategy. 
The resulting trajectories respect kinodynamic constraints up to the jerk level, enabling time-optimal connections between two given states. 
Another example is the minimum snap trajectory generation method~\cite{cMinimumSnap}, which contrasts with the bang-bang snap strategy of kino-splines. 
Also based on system differential flatness, this approach formulates an optimization problem that minimizes the integral of a weighted combination of squared position snap and squared yaw acceleration.
It ensures continuity between trajectory segments, satisfies kinematic conditions at the start and end of the motion, and respects actuation limits.

While the local planners mentioned earlier primarily focus on enforcing kinodynamic constraints, BÃ©zier curve-based planners~\cite{cBezier,cBezier2} offer additional benefits due to their inherent smoothness, and their convex hull property.
Their convex hull property ensures that the trajectory remains within the convex hull of its control points. 
This simplifies collision detection, as it guarantees that if the convex hull is free of obstacles, the entire trajectory will be too. 
Additionally, adjusting control points affects only a localized portion of the trajectory, allowing precise modifications without affecting the entire trajectory. 
This approach is particularly useful in environments where efficient collision detection is crucial.
Furthermore, its smoothness also naturally accommodates velocity, acceleration, and higher-order dynamic constraints, making it suitable for kinodynamic motion planning in various robotic systems. 

Another powerful method is \gls{chomp}~\cite{cCHOMP}, which formulates trajectory generation as an optimization problem starting from an initial trajectory as guess. 
The cost function in \myglsentry{chomp} typically balances smoothness and obstacle avoidance.
Smoothness is ensured by penalizing higher derivatives of the trajectory, while obstacle avoidance is achieved through the use of a signed distance field. 
\myglsentry{chomp} can incorporate dynamic and kinematic constraints, such as joint limits and velocity bounds, which are important for kinodynamic planning. 
Using gradient-based optimization, \myglsentry{chomp} iteratively refines the initial trajectory, ensuring that it satisfies all constraints while minimizing the cost function. 
While effective in high-dimensional or cluttered environments, \myglsentry{chomp} does require a good initial trajectory and can struggle in environments with non-convex obstacles.

While \myglsentry{chomp} can handle differentiable cost function due its gradient-based optimization, the \gls{stomp} algorithm~\cite{cSTOMP} is designed to optimize non-differentiable cost functions. 
\myglsentry{stomp} iteratively improves trajectories by introducing small perturbations to the initial guess, evaluating the resulting costs, and updating the trajectory based on the best-performing samples. 
This process also accounts for kinodynamic constraints and obstacle avoidance by adding state cost penalty in the cost function formulation.
While \myglsentry{stomp} is computationally more expensive than \myglsentry{chomp} as it relies on several sampling-based rollouts, its ability to handle more complex cost functions and find better solutions in challenging environments makes it highly versatile for kinodynamic motion planning.

\subsubsection{Forward propagation}\label{sec:forwardplanning}

Global sampling-based motion planners can generate globally kinodynamically feasible trajectories by leveraging the aforementioned local planners to connect their sampled state.
However, such local planners may not be available for every system.
Therefore, algorithms were developed to bypass this need by performing dynamic system forward propagation instead of solving a complex \myglsentry{bvp}.

Kinodynamic motion planners, such as Kinodynamic RRT~\cite{cKinoRRT} and \gls{sst}~\cite{cSST}, are designed to address the challenges of planning for robots with complex dynamics without relying on a local planner. 
These methods utilize system forward dynamic propagation by sampling control inputs and propagation time. 
Starting from an initial robot state, the system dynamics are integrated in an open-loop manner to propagate the state, allowing the planner to account for both the robot kinematic limitations and its dynamic behavior. 
This approach ensures that the generated paths are collision-free and physically executable while eliminating the need for local planners.

\section{Planning under uncertainty}\label{sec:planuncertainty}

While the previous section focused on motion planning algorithms that can deal with kinodynamic constraints of various robot, none of them consider the unavoidable presence of uncertainties (e.g. external disturbances, sensor noise, model parameter mismatches, etc.).

A common approach to managing uncertainties is to compensate for them in real-time using robust controllers, such as H-infinity or \gls{lpv} methods.
However, these methods often encounter difficulties in maintaining robustness when applied to non-robust reference trajectories, due to their inherently local nature.
Additionally, they struggle to achieve global optimality and performance, which are typically better addressed by global planning approaches.
Therefore, considerable research has focused on designing motion planning algorithms that incorporate uncertainty into the trajectory generation process, with the goal of producing robust and feasible plans.

A seminal contribution to the field is the \gls{lmt} framework~\cite{cLMT}, which addresses the challenge of computing compliant motion strategies in the presence of sensor uncertainties and inaccuracies in robot movement. 
This approach focuses on developing fine-motion strategies, which involve incrementally generating sequences of robot movements that account for inaccuracies in both the robot state and the sensed environment. 
The authors consider the robot kinematic constraints and sources of error, such as sensor discrepancies or movement inaccuracies.
By ensuring that the robot motions remain collision-free and adaptable to these uncertainties, the framework aims to achieve robustness in real-world tasks.
However, a bottleneck of the method is its high computational cost.

By leveraging the probabilistic robotic concept~\cite{cProbaRobotic}, approaches such as \gls{pomdp} or, in general, the class of âplanning in belief spacesâ approaches, are another alternative for providing a principled and general planning framework for dealing with uncertainty.
They use stochastic uncertainty propagation functions, to minimize the uncertainty along the trajectory to the desired target~\cite{cUncertaintyPOMDP,cNavigationPOMPDP}. 
\myglsentry{pomdp} model sequential decision-making in environments with uncertainty, considering both actions taken by the agent and the uncertain nature of observations and transitions.
The proposed frameworks have the advantage of being adaptable to a wide range of non-trivial robot models, with non-Gaussian processes and observation models for trajectory planning with minimum uncertainty.
However, these methods still suffer from computational bottleneck when dealing with high dimensional problems.

When probability distributions over uncertain variables are available, chance-constrained motion planning can be used to generate plans that satisfy probabilistic constraints~\cite{cChance1,cChance2,cChance3}. 
These constraints ensure that specific conditions, such as safety or feasibility, are met with a certain probability. 
Typically, a chance constraint is incorporated into an optimization problem, where the objective (e.g., minimizing cost or maximizing reward) is optimized while ensuring that the constraint holds with a high probability (e.g. ensuring that a robot avoids obstacles with 95\% probability).

Particle-based methods such as Particle RRT~\cite{cParticleRRT} or RRT-SALM~\cite{cSlamRRT}, use particle filters to model uncertainty. 
Rather than relying on a single robot state, these algorithms represent the robot state as a set of particles, each corresponding to a possible uncertain state. 
The particles are propagated through the environment according to the system dynamic, and the tree is expanded by sampling from these particles.

The problem of generating open-loop trajectories with minimum state sensitivity has been recently addressed in~\cite{cSensi1} and further expanded upon in~\cite{cSensi2}. 
This later work introduces a method for generating robust trajectories using an open-loop optimization routine that accounts for deviations in model parameters. 
In contrast to the aforementioned probabilistic approaches, this framework operates under the assumption of accurate models and demonstrates that minimizing first-order sensitivities leads to reduced deviations from the nominal state when model parameters are imperfect.

\section{Control-aware motion planning}

The algorithms presented so far have been designed to handle kinodynamic constraints and/or ensure robustness against various uncertainties.
However, none of them typically consider the inevitable presence of a feedback controller responsible for executing the generated trajectories. 
This controller might deviate from the planned trajectory to address uncertainties and disturbances, which can quickly compromise feasibility and optimality of the plan.
It is important to note that kinodynamic approaches relying on system dynamics forward propagation, as discussed in Section~\ref{sec:forwardplanning}, do not incorporate feedback actions.
Instead, they directly sample in the control input space, resulting in an open-loop propagation strategy.

The idea of merging planning with control for generating ârobust plannersâ or more âglobal controllersâ for dealing with the robustness problem in a more comprehensive way is however not completely novel in the robotics community.
This yields to the 'feedback motion planning' (or control-aware motion planning) paradigm.

Work has been carried out on the control community side to propose ``less local'' controllers, resulting in the popular \gls{mpc} technique~\cite{cMPC} that iteratively replans an optimal (and feasible) trajectory with a feedback from the current robot state (that may deviate from the desired one because of disturbances/uncertainties). 
This method enables fast computation of locally optimal trajectories while incorporating the controller feedback action. 
However, due to its inherently local nature, the \myglsentry{mpc} approach can become trapped in local minima with respect to cost or obstacles. 
It often lacks guarantees of completeness and relies heavily on an accurate robot model, without explicitly accounting for uncertainties.

A seminal work in feedback motion planning is the LQR-Trees method~\cite{cLQRTrees}.
This addresses the problem of generating global trajectories that are stabilizable.
While the decoupled planning and control method is effective in many cases, it may result in trajectories that are either not stabilizable or significantly more costly to stabilize compared to alternative, more optimal trajectories.
Therefore, the LQR-Trees method combines trajectory optimization, feedback control, and Lyapunov verification to construct a tree of locally valid control policies.
This structure efficiently covers the state space and facilitates the generation of low-cost stabilization trajectories.
The approach operates as follows:
\begin{enumerate}
    \item Local Control via \gls{lqr}: The system starts by generating a trajectory to a goal state using a trajectory optimization method. 
    A local \myglsentry{lqr} controller is then synthesized to stabilize the system around this trajectory.

    \item \gls{sos} Verification: A polynomial Lyapunov function is used to certify regions of attraction around the trajectory. 
    This involves verifying the system stability and feasibility within the computed region using \myglsentry{sos} optimization.
    
    \item Tree Construction: The algorithm iteratively adds new trajectories and their associated controllers to a tree structure. 
    New trajectories are initialized from states that fall outside existing regions of attraction, progressively expanding the tree to cover the state space.
\end{enumerate}
While the LQR-Trees approach provides a scalable and efficient solution for motion planning in nonlinear and high-dimensional spaces, effectively bridging the gap between open-loop planning and control, its applicability is constrained to the \myglsentry{lqr} control formulation.

Another notable contribution to control-aware motion planning is presented in~\cite{cTognon}. 
This work focuses on motion planning methods that account for the system dynamic model and control capabilities, particularly in the context of task constraints imposed by the aerial manipulator mission.
It introduces an innovative motion planning framework that integrates control limitations by conducting system closed-loop simulations during the extension phase of a sampling-based planner, ensuring the feasibility of the generated trajectories for the manipulator control system.
However, this method does not explicitly account for uncertainties.

\section{Robust control-aware motion planning}

Although the previously mentioned methods have bridged the gap between motion planning and control, they do not explicitly address uncertainties or how the controller will respond to such uncertainties to mitigate their effects.
An effective framework should ensure safe operation under uncertainty by considering the role of a feedback controller. 
This challenge is known as robust control-aware motion planning, or robust feedback motion planning.

To address this challenge, an extension of standard \myglsentry{mpc}, known as \gls{tmpc}, has been introduced in~\cite{cTMPC}.
\myglsentry{tmpc} is a robust control strategy designed to handle uncertainties in dynamic systems while maintaining performance and stability. 
It generates a nominal trajectory using \myglsentry{mpc} and defines an invariant "tube" around this trajectory, within which the system state must remain. 
A feedback controller is then applied to ensure that, despite disturbances or model inaccuracies, the system trajectory stays within the tube, thus maintaining robustness and stability. 
This approach allows \myglsentry{tmpc} to handle uncertainties effectively while ensuring the system follows a desired trajectory, making it particularly useful in safety-critical applications.
However, \myglsentry{tmpc} faces similar challenges as its non-robust counterpart, such as the risk of getting trapped in local minima with respect to cost or obstacles.
Additionally, \myglsentry{tmpc} and \myglsentry{mpc}, being model-based techniques, are highly sensitive to model uncertainties.

The FaSTrack framework~\cite{cFaSTrack} is a motion planning approach designed to address the challenges of fast, adaptive, and robust trajectory generation for dynamic systems, particularly in the context of autonomous vehicles or robots. 
It integrates real-time feedback to rapidly adjust planned trajectories in response to changes in the environment or the system state. 
The FasTrack framework relies on a simplified robot dynamic model, and its robustness is ensured by synthesizing a specific control strategy tailored to the system, which helps it adapt to disturbances and uncertainties.
Therefore, this technique is limited to the specific synthesized controller, and limited by its simplified representation.

While the LQR-Trees approach previously focused on trajectory stability and relied solely on \myglsentry{lqr} control, the formulation was later extended in the Funnel Library approach~\cite{cMajundarLibrary}.
The core idea of the Funnel Library is to generate control policies that ensure the system trajectory remains within a "tube" around a desired reference trajectory, which is a bounded region where the system is guaranteed to stay despite external disturbances.
The framework extends its former LQR-Trees approache to include controllers of polynomial form that can handle non linearities, disturbances, and model uncertainties.
It employs an optimization-based method to design an offline library of control policies that are robust to model errors and external uncertainties. 
A key advantage of the Funnel Library is its ability to perform real-time updates by searching through the library and combining subsequent tubes online. 
This allows the control policies to adapt dynamically based on feedback, ensuring that the system can respond to environmental or state changes effectively.
However, the method is limited to controllers of polynomial form, and its planning capabilities are constrained by the finite set of control law in the library.

A seminal contribution to the field is the contraction theory approach, which has served as the foundation for several subsequent works~\cite{cContractThControl,cContractThControlLearning,cContractThMP,cContractThOnlineMP}.
Contraction theory is a generalization of Lyapunov theory used to analyze and design robust control systems, particularly in the presence of uncertainties or disturbances. 
The core idea is to ensure that the system state trajectories converge towards a desired reference trajectory, regardless of initial conditions or external disturbances. 
This is achieved by requiring that the system dynamics exhibit a "contracting" behavior, meaning that the distance between any two trajectories decreases over time. 
In contraction theory, the system dynamics are typically modeled using differential equations, and the stability of the system is guaranteed by synthesizing a controller associated with a contraction rate such that the contraction condition holds. 
Contraction theory has been leveraged to design "tubes" by determining bounds on the controller "contraction rate". 
These tubes are then employed to develop robust motion planning algorithms. 
Consequently, these methods remain limited to the use of specific controllers, which may not always be amenable to a reasonably simple implementation in real-world cases.

While the aforementioned methods explicitly focus on generating robust trajectories to external disturbances or unmodeled forces (e.g., wind, friction), none of them considers potential mismatches or fluctuations in the robot model parameters during runtime, such as changes in mass or displacements of the center of mass.
Such robot model inaccuracy can strongly impact their efficiency, as they are strong model based approaches. 
Moreover, many of these methods hold for a specific class of systems or a specific synthesized controller and, thus, lack generality.

To tackle some of these issues, the RandUp-RRT proposed in~\cite{cRandUpRRT}, builds upon the aforementioned particle-based RRT, by performing a random uncertainty propagation (RandUP)~\cite{cRandUP}, taking into account a feedback action of a given controller.
The idea is to estimate for each node of the tree the set of states that can be reached by the system using `particles', which corresponds to a dynamic propagation of the system in the presence of random parameters uncertainty.
Furthermore, these sets can be approximated for any system and controller.
However, the guarantee that these reachable sets are conservative relies on additional padding or a large number of particles, and the more particles considered, the longer the computation time will be compared to conventional algorithms.
Nevertheless, this work is the closest to the one presented in this thesis and will be used as a baseline for comparison.

As mentioned in Section~\ref{sec:planuncertainty}, \emph{sensitivity}-based planning is a concept that explicitly account for parameters model uncertainty.
However, in the work of~\cite{cSensi1,cSensi2}, it is considered only an open loop manner.
This concept was recently expanded to include closed-loop sensitivity~\cite{cPi,cTh}, which accounts for any controller applying feedback to an uncertain system, thus enabling the consideration of uncertainty for any robot/controller combination. 
Building on this recent development, this thesis leverages widely used sampling-based motion planners and the closed-loop sensitivity notion, further discussed in Chapter~\ref{chap:models}, to introduce a new class of robust control-aware motion planners applicable to any robot and controller, specifically addressing parametric uncertainty. 
For clarity, this thesis refers to this new concept as \emph{sensitivity}.